function $(element){return"string"==typeof element?$element.selected=document.querySelector(element):$element.selected=element,$element}var $browser={belowIE10:function(){return/MSIE\s/.test(navigator.userAgent)&&parseFloat(navigator.appVersion.split("MSIE")[1])<10}},$events={terms:[{name:"enter",code:13},{name:"space",code:32}],find:function(term){for(var i=this.terms.length-1;i>=0;i--)if(this.terms[i].name===term)return this.terms[i]}},$element={selected:{},module:function(arr,onLoad){window.onload=function(){onLoad()}},controller:function(settings,toRun){var $scope=[];toRun($scope);var keysPressed=this.selected.querySelectorAll("[data-keypress]"),models=this.selected.querySelectorAll("[data-model]"),repeats=this.selected.querySelectorAll("[data-repeat]"),templates=this.selected.querySelectorAll("[data-template]");for(i=0;i<templates.length;i++){var template=$(templates[i]),attrs=template.attributes(),url=attrs["data-template"].value;$ajax.get(url).success(function(contents){template.template($scope,contents)})}for(i=0;i<models.length;i++){var mod=$(models[i]),attrs=mod.attributes(),model=attrs["data-model"].value;$scope=mod.watch($scope,model)}for(i=0;i<repeats.length;i++){var holder,repeat=$(repeats[i]),attrs=repeat.attributes(),val=attrs["data-repeat"].value,scope=$scope[val];for(s=0;s<scope.length;s++)scope[s].$index=s,holder+=Mustache.render(repeats[i].outerHTML,scope[s]);repeats[i].outerHTML=holder.split("undefined")[1]}for(i=0;i<keysPressed.length;i++){var kp=$(keysPressed[i]),attrs=kp.attributes(),expression=attrs["data-keypress"].value;kp.keypress(expression)}},attr:function(value,newValue){for(i=0;i<this.selected.attributes.length;i++){var attribute=this.selected.attributes[i];if(attribute.name===value)return newValue&&(attribute.value=newValue),attribute.value}},attributes:function(){return this.selected.attributes},hasClass:function(theClass){for(i=0;i<this.selected.attributes.length;i++){var attribute=this.selected.attributes[i];if("class"===attribute.name)var classes=attribute.value.split(" ")}for(i=0;i<classes.length;i++)if(classes[i]===theClass)var status=!0;return status===!0?!0:!1},append:function(item){return this.selected.innerHTML+=item,this},position:function(){for(var xPosition=0,yPosition=0;this.selected;)xPosition+=this.selected.offsetLeft-this.selected.scrollLeft+this.selected.clientLeft,yPosition+=this.selected.offsetTop-this.selected.scrollTop+this.selected.clientTop,this.selected=this.selected.offsetParent;return{x:xPosition,y:yPosition}},html:function(newHTML){return newHTML?(this.selected.innerHTML=newHTML,this):this.selected.innerHTML},addClass:function(newClass){if(null===this.selected.getAttribute("class")){var att=document.createAttribute("class");att.value=newClass,this.selected.setAttributeNode(att)}else{var att=this.selected.getAttribute("class")+" "+newClass;this.selected.setAttribute("class",att)}return this},removeClass:function(deleteClass){for(i=0;i<this.selected.attributes.length;i++){var attribute=this.selected.attributes[i];"class"===attribute.name&&""!==attribute.value&&(attribute.value="")}return this},click:function(toRun){return this.selected.onclick=function(e){e.preventDefault(),toRun()},this},fadeIn:function(){var el=this.selected;el.classList.contains("is-hidden")&&el.classList.remove("is-hidden"),el.style.opacity=0,function fade(){var val=parseFloat(el.style.opacity);(val+=.1)>1||(el.style.opacity=val,requestAnimationFrame(fade))}()},fadeOut:function(){var el=this.selected;el.style.opacity=1,function fade(){(el.style.opacity-=.1)<0?(el.style.display="none",el.classList.add("is-hidden")):requestAnimationFrame(fade)}()},ga:function(category,label,value){return console.log("send","event",category,"click",label,value),this},parent:function(){return this.selected=this.selected.parentNode,this},repeat:function(repeatBy,toRun){var elem=this.parent().position();document.elementFromPoint(elem.x,elem.y);return this},watch:function(scope,model){return"checkbox"==this.selected.type?this.selected.onclick=function(e){scope[model]!==!0?scope[model]=!0:scope[model]=!1}:(this.selected.onkeypress=function(e){scope[model]=e.target.value},this.selected.onchange=function(e){scope[model]=e.target.value}),scope},keypress:function(expression,toRun){if(void 0!==expression){var spl=expression.split(":");if(spl.length>1){for(var i=spl.length-1;i>=0;i--)spl[i]=spl[i].replace(/\s+/g,""),spl[i]=spl[i].split("(");var term=spl[0][0],find=$events.find(term);if(!find||"function"!=typeof $scope[spl[1][0]])throw new Error("You have an error in your expression");this.selected.onkeypress=function(e){return e.keyCode===find.code?$scope[spl[1][0]]():void 0}}else{var term=spl[0],find=$events.find(term);if(!find||"function"!=typeof toRun)throw new Error("You have an error in your expression");this.selected.onkeypress=function(e){return e.keyCode===find.code?toRun(e):void 0}}}else this.selected.onkeypress=function(e){console.log(e)}},template:function(input,template){if("undefined"==typeof Handlebars)if("object"!=typeof input){if(!template)throw new Error("you have not specified a template");var complied=Mustache.render(template,{data:input});this.selected.innerHTML+=complied}else if(/<[a-z][\s\S]*>/i.test(input.template)){var compiled=Mustache.render(input.template,{data:input.data});this.selected.innerHTML+=compiled}else{var handle=Mustache.render(template,input);this.selected.innerHTML+=handle}else if("object"!=typeof input){if(!template)throw new Error("you have not specified a template");var compiled=Handlebars.compile(template);this.selected.innerHTML+=compiled({data:input})}else if(/<[a-z][\s\S]*>/i.test(input.template)){var compiled=Handlebars.compile(input.template);this.selected.innerHTML+=compiled({data:input.data})}else{var handle=Handlebars.compile(template),html=handle(input);this.selected.innerHTML+=html}return this}},$ajax={xhr:{},get:function(url,async){var xhr=new XMLHttpRequest;if("boolean"==typeof async)xhr.open("GET",url,async),xhr.send(null),this.xhr=xhr;else{if("undefined"!=typeof async)throw new Error("Async needs to be a boolean");xhr.open("GET",url,!1),xhr.send(null),this.xhr=xhr}if("string"!=typeof url)throw new Error("Not a valid URL");return this},success:function(funct){function tryParseJSON(jsonString){try{var o=JSON.parse(jsonString);if(o&&"object"==typeof o&&null!==o)return o}catch(e){}return!1}var isJSON=tryParseJSON(this.xhr.responseText);funct(isJSON!==!1?isJSON:this.xhr.responseText)}};!function(global,factory){"object"==typeof exports&&exports?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):(Mustache={},factory(Mustache))}(this,function(mustache){function isFunction(object){return"function"==typeof object}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function testRegExp(re,string){return regExpTest.call(re,string)}function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}function escapeHtml(string){return String(string).replace(/[&<>"'\/]/g,function(s){return entityMap[s]})}function parseTemplate(template,tags){function stripSpace(){if(hasTag&&!nonSpace)for(;spaces.length;)delete tokens[spaces.pop()];else spaces=[];hasTag=!1,nonSpace=!1}function compileTags(tagsToCompile){if("string"==typeof tagsToCompile&&(tagsToCompile=tagsToCompile.split(spaceRe,2)),!isArray(tagsToCompile)||2!==tagsToCompile.length)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*"),closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1])),closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}if(!template)return[];var openingTagRe,closingTagRe,closingCurlyRe,sections=[],tokens=[],spaces=[],hasTag=!1,nonSpace=!1;compileTags(tags||mustache.tags);for(var start,type,value,chr,token,openSection,scanner=new Scanner(template);!scanner.eos();){if(start=scanner.pos,value=scanner.scanUntil(openingTagRe))for(var i=0,valueLength=value.length;valueLength>i;++i)chr=value.charAt(i),isWhitespace(chr)?spaces.push(tokens.length):nonSpace=!0,tokens.push(["text",chr,start,start+1]),start+=1,"\n"===chr&&stripSpace();if(!scanner.scan(openingTagRe))break;if(hasTag=!0,type=scanner.scan(tagRe)||"name",scanner.scan(whiteRe),"="===type?(value=scanner.scanUntil(equalsRe),scanner.scan(equalsRe),scanner.scanUntil(closingTagRe)):"{"===type?(value=scanner.scanUntil(closingCurlyRe),scanner.scan(curlyRe),scanner.scanUntil(closingTagRe),type="&"):value=scanner.scanUntil(closingTagRe),!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);if(token=[type,value,start,scanner.pos],tokens.push(token),"#"===type||"^"===type)sections.push(token);else if("/"===type){if(openSection=sections.pop(),!openSection)throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else"name"===type||"{"===type||"&"===type?nonSpace=!0:"="===type&&compileTags(value)}if(openSection=sections.pop())throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){for(var token,lastToken,squashedTokens=[],i=0,numTokens=tokens.length;numTokens>i;++i)token=tokens[i],token&&("text"===token[0]&&lastToken&&"text"===lastToken[0]?(lastToken[1]+=token[1],lastToken[3]=token[3]):(squashedTokens.push(token),lastToken=token));return squashedTokens}function nestTokens(tokens){for(var token,section,nestedTokens=[],collector=nestedTokens,sections=[],i=0,numTokens=tokens.length;numTokens>i;++i)switch(token=tokens[i],token[0]){case"#":case"^":collector.push(token),sections.push(token),collector=token[4]=[];break;case"/":section=sections.pop(),section[5]=token[2],collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}return nestedTokens}function Scanner(string){this.string=string,this.tail=string,this.pos=0}function Context(view,parentContext){this.view=view,this.cache={".":this.view},this.parent=parentContext}function Writer(){this.cache={}}var objectToString=Object.prototype.toString,isArray=Array.isArray||function(object){return"[object Array]"===objectToString.call(object)},regExpTest=RegExp.prototype.test,nonSpaceRe=/\S/,entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},whiteRe=/\s*/,spaceRe=/\s+/,equalsRe=/\s*=/,curlyRe=/\s*\}/,tagRe=/#|\^|\/|>|\{|&|=|!/;Scanner.prototype.eos=function(){return""===this.tail},Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(!match||0!==match.index)return"";var string=match[0];return this.tail=this.tail.substring(string.length),this.pos+=string.length,string},Scanner.prototype.scanUntil=function(re){var match,index=this.tail.search(re);switch(index){case-1:match=this.tail,this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index),this.tail=this.tail.substring(index)}return this.pos+=match.length,match},Context.prototype.push=function(view){return new Context(view,this)},Context.prototype.lookup=function(name){var value,cache=this.cache;if(name in cache)value=cache[name];else{for(var names,index,context=this,lookupHit=!1;context;){if(name.indexOf(".")>0)for(value=context.view,names=name.split("."),index=0;null!=value&&index<names.length;)index===names.length-1&&null!=value&&(lookupHit="object"==typeof value&&value.hasOwnProperty(names[index])),value=value[names[index++]];else null!=context.view&&"object"==typeof context.view&&(value=context.view[name],lookupHit=context.view.hasOwnProperty(name));if(lookupHit)break;context=context.parent}cache[name]=value}return isFunction(value)&&(value=value.call(this.view)),value},Writer.prototype.clearCache=function(){this.cache={}},Writer.prototype.parse=function(template,tags){var cache=this.cache,tokens=cache[template];return null==tokens&&(tokens=cache[template]=parseTemplate(template,tags)),tokens},Writer.prototype.render=function(template,view,partials){var tokens=this.parse(template),context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)},Writer.prototype.renderTokens=function(tokens,context,partials,originalTemplate){for(var token,symbol,value,buffer="",i=0,numTokens=tokens.length;numTokens>i;++i)value=void 0,token=tokens[i],symbol=token[0],"#"===symbol?value=this.renderSection(token,context,partials,originalTemplate):"^"===symbol?value=this.renderInverted(token,context,partials,originalTemplate):">"===symbol?value=this.renderPartial(token,context,partials,originalTemplate):"&"===symbol?value=this.unescapedValue(token,context):"name"===symbol?value=this.escapedValue(token,context):"text"===symbol&&(value=this.rawValue(token)),void 0!==value&&(buffer+=value);return buffer},Writer.prototype.renderSection=function(token,context,partials,originalTemplate){function subRender(template){return self.render(template,context,partials)}var self=this,buffer="",value=context.lookup(token[1]);if(value){if(isArray(value))for(var j=0,valueLength=value.length;valueLength>j;++j)buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate);else if("object"==typeof value||"string"==typeof value||"number"==typeof value)buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate);else if(isFunction(value)){if("string"!=typeof originalTemplate)throw new Error("Cannot use higher-order sections without the original template");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender),null!=value&&(buffer+=value)}else buffer+=this.renderTokens(token[4],context,partials,originalTemplate);return buffer}},Writer.prototype.renderInverted=function(token,context,partials,originalTemplate){var value=context.lookup(token[1]);return!value||isArray(value)&&0===value.length?this.renderTokens(token[4],context,partials,originalTemplate):void 0},Writer.prototype.renderPartial=function(token,context,partials){if(partials){var value=isFunction(partials)?partials(token[1]):partials[token[1]];return null!=value?this.renderTokens(this.parse(value),context,partials,value):void 0}},Writer.prototype.unescapedValue=function(token,context){var value=context.lookup(token[1]);return null!=value?value:void 0},Writer.prototype.escapedValue=function(token,context){var value=context.lookup(token[1]);return null!=value?mustache.escape(value):void 0},Writer.prototype.rawValue=function(token){return token[1]},mustache.name="mustache.js",mustache.version="2.0.0",mustache.tags=["{{","}}"];var defaultWriter=new Writer;mustache.clearCache=function(){return defaultWriter.clearCache()},mustache.parse=function(template,tags){return defaultWriter.parse(template,tags)},mustache.render=function(template,view,partials){return defaultWriter.render(template,view,partials)},mustache.to_html=function(template,view,partials,send){var result=mustache.render(template,view,partials);return isFunction(send)?void send(result):result},mustache.escape=escapeHtml,mustache.Scanner=Scanner,mustache.Context=Context,mustache.Writer=Writer});